<!doctype html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="总结," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="##1.线段树#
一是非常裸的题,二是延时标记,三是扫描线.扫描线我是没有学的,广林研究出来了,像ARENA上那道”简单的线段树”,我打算明后天在做…

COGS 58 延绵的山峰">
<meta property="og:type" content="article">
<meta property="og:title" content="5.15-6.5 OI 总结2(线段树,单调队列)">
<meta property="og:url" content="http://stdafx.ga/2015/06/07/5-15-6-5-OI-总结2/index.html">
<meta property="og:site_name" content="stdafx's Blog">
<meta property="og:description" content="##1.线段树#
一是非常裸的题,二是延时标记,三是扫描线.扫描线我是没有学的,广林研究出来了,像ARENA上那道”简单的线段树”,我打算明后天在做…

COGS 58 延绵的山峰">
<meta property="og:updated_time" content="2016-02-09T02:15:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5.15-6.5 OI 总结2(线段树,单调队列)">
<meta name="twitter:description" content="##1.线段树#
一是非常裸的题,二是延时标记,三是扫描线.扫描线我是没有学的,广林研究出来了,像ARENA上那道”简单的线段树”,我打算明后天在做…

COGS 58 延绵的山峰">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'stdafx'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://stdafx.ga/2015/06/07/5-15-6-5-OI-总结2/"/>





  <title> 5.15-6.5 OI 总结2(线段树,单调队列) | stdafx's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9c616d8a49183f1ab5abf3385d00a440";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">stdafx's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Welcome</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://stdafx.ga/2015/06/07/5-15-6-5-OI-总结2/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="stdafx">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="stdafx's Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="stdafx's Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                5.15-6.5 OI 总结2(线段树,单调队列)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-07T13:53:08+08:00">
                2015-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2015/06/07/5-15-6-5-OI-总结2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/06/07/5-15-6-5-OI-总结2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>##1.线段树#</p>
<p>一是非常裸的题,二是延时标记,三是扫描线.扫描线我是没有学的,广林研究出来了,像ARENA上那道”简单的线段树”,我打算明后天在做…</p>
<ul>
<li><strong>COGS 58 延绵的山峰</strong></li>
</ul>
<a id="more"></a>
<p>问题描述</p>
<p>有一座延绵不断、跌宕起伏的山，最低处海拔为0，最高处海拔不超过8848米，从这座山的一端走到另一端的过程中，每走1米海拔就升高或降低1米。有Q个登山队计划在这座山的不同区段登山，当他们攀到各自区段的最高峰时，就会插上队旗。请你写一个程序找出他们插旗的高度。</p>
<p>/*</p>
<p>裸的不能再裸了…就是求区间最大值.</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINETREE</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1000010</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"> </div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> tree[MAXN*<span class="number">5</span>],pos,n,q,posl,posr;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>;<span class="keyword">bool</span> flag=<span class="number">0</span>;<span class="keyword">char</span> c=getchar();</div><div class="line">	<span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)&#123;</div><div class="line">		<span class="keyword">if</span>(c==<span class="string">'-'</span>) flag=<span class="number">1</span>;</div><div class="line">		c=getchar();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())&#123;</div><div class="line">		x=x*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(flag) <span class="keyword">return</span> -x;</div><div class="line">	<span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		tree[rt]=in();</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	Build(lson);</div><div class="line">	Build(rson);</div><div class="line">	tree[rt]=MAX(tree[t],tree[t|<span class="number">1</span>]);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(posl&lt;=l&amp;&amp;posr&gt;=r)&#123;</div><div class="line">		<span class="keyword">return</span> tree[rt];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>,Max=<span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(posl&lt;=m)&#123;</div><div class="line">		<span class="keyword">int</span> tp=Query(lson);</div><div class="line">		Max=MAX(Max,tp);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(posr&gt;m)&#123;</div><div class="line">        <span class="keyword">int</span> tp=Query(rson);</div><div class="line">		Max=MAX(Max,tp);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> Max;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"climb.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"climb.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	n=in();</div><div class="line">	Build(<span class="number">0</span>,n,<span class="number">1</span>);</div><div class="line">	q=in();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</div><div class="line">	    posl=in();posr=in();</div><div class="line">	    <span class="built_in">printf</span>(<span class="string">"%d"</span>,Query(<span class="number">0</span>,n,<span class="number">1</span>));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><strong>HDU 1166 敌兵布阵</strong></li>
</ul>
<p>C国的死对头A国这段时间正在进行军事演习，所以C国间谍头子Derek和他手下Tidy又开始忙乎了。A国在海岸线沿直线布置了N个工兵营地,Derek和Tidy的任务就是要监视这些工兵营地的活动情况。由于采取了某种先进的监测手段，所以每个工兵营地的人数C国都掌握的一清二楚,每个工兵营地的人数都有可能发生变动，可能增加或减少若干人手,但这些都逃不过C国的监视。</p>
<p>中央情报局要研究敌人究竟演习什么战术,所以Tidy要随时向Derek汇报某一段连续的工兵营地一共有多少人,例如Derek问:“Tidy,马上汇报第3个营地到第10个营地共有多少人!”Tidy就要马上开始计算这一段的总人数并汇报。但敌兵营地的人数经常变动，而Derek每次询问的段都不一样，所以Tidy不得不每次都一个一个营地的去数，很快就精疲力尽了，Derek对Tidy的计算速度越来越不满:”你个死肥仔，算得这么慢，我炒你鱿鱼!”Tidy想：“你自己来算算看，这可真是一项累人的工作!我恨不得你炒我鱿鱼呢!”无奈之下，Tidy只好打电话向计算机专家Windbreaker求救,Windbreaker说：“死肥仔，叫你平时做多点acm题和看多点算法书，现在尝到苦果了吧!”Tidy说：”我知错了。。。”但Windbreaker已经挂掉电话了。Tidy很苦恼，这么算他真的会崩溃的，聪明的读者，你能写个程序帮他完成这项工作吗？不过如果你的程序效率不够高的话，Tidy还是会受到Derek的责骂的.</p>
<p>第一行一个整数T，表示有T组数据。<br>每组数据第一行一个正整数N（N&lt;=50000）,表示敌人有N个工兵营地，接下来有N个正整数,第i个正整数ai代表第i个工兵营地里开始时有ai个人（1&lt;=ai&lt;=50）。<br>接下来每行有一条命令，命令有4种形式：</p>
<p>(1) Add i j,i和j为正整数,表示第i个营地增加j个人（j不超过30）</p>
<p>(2)Sub i j ,i和j为正整数,表示第i个营地减少j个人（j不超过30;</p>
<p>(3)Query i j ,i和j为正整数,i&lt;=j，表示询问第i到第j个营地的总人数;</p>
<p>(4)End 表示结束，这条命令在每组数据最后出现;</p>
<p>每组数据最多有40000条命令</p>
<p>/*</p>
<p>也是非常裸的一道线段树,区间改值,求和.</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINETREE</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">WORK</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">char</span> c=getchar();</div><div class="line">    <span class="keyword">int</span> x=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)c=getchar();</div><div class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())x=x*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> tree[<span class="number">200000</span>],temp,t,a,b,n;</div><div class="line"><span class="keyword">char</span> inp[<span class="number">20</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    t=in();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=t;i++)&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>,i);</div><div class="line">        WORK();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">WORK</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    n=in();</div><div class="line">    BUILD(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,inp);</div><div class="line">        <span class="keyword">if</span>(inp[<span class="number">0</span>]==<span class="string">'E'</span>) <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(inp[<span class="number">0</span>]==<span class="string">'A'</span>)&#123;</div><div class="line">            a=in();b=in();</div><div class="line">            UPDATE(a,b,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(inp[<span class="number">0</span>]==<span class="string">'S'</span>)&#123;</div><div class="line">            a=in();b=in();</div><div class="line">            UPDATE(a,-b,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(inp[<span class="number">0</span>]==<span class="string">'Q'</span>)&#123;</div><div class="line">            a=in();b=in();</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,QUERY(a,b,<span class="number">1</span>,n,<span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">memset</span>(tree,<span class="number">0</span>,<span class="keyword">sizeof</span>(tree));</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;</div><div class="line">        tree[rt]=in();</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>,temp=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    BUILD(l,mid,temp);</div><div class="line">    BUILD(mid+<span class="number">1</span>,r,temp|<span class="number">1</span>);</div><div class="line">    tree[rt]=tree[temp]+tree[temp|<span class="number">1</span>];</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> new_data,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;</div><div class="line">        tree[rt]+=new_data;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>,temp=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(pos&lt;=mid)&#123;</div><div class="line">        UPDATE(pos,new_data,l,mid,temp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        UPDATE(pos,new_data,mid+<span class="number">1</span>,r,temp|<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    tree[rt]=tree[temp]+tree[temp|<span class="number">1</span>];</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span> pos_l,<span class="keyword">int</span> pos_r,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(pos_l&lt;=l&amp;&amp;pos_r&gt;=r)&#123;</div><div class="line">        <span class="keyword">return</span> tree[rt];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> SUM=<span class="number">0</span>,mid=(l+r)&gt;&gt;<span class="number">1</span>,temp=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(pos_l&lt;=mid)&#123;</div><div class="line">        SUM+=QUERY(pos_l,pos_r,l,mid,temp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(pos_r&gt;mid)&#123;</div><div class="line">        SUM+=QUERY(pos_l,pos_r,mid+<span class="number">1</span>,r,temp|<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> SUM;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><strong>HDU 1754 I Hate It</strong></li>
</ul>
<p>很多学校流行一种比较的习惯。老师们很喜欢询问，从某某到某某当中，分数最高的是多少。<br>这让很多学生很反感。</p>
<p>不管你喜不喜欢，现在需要你做的是，就是按照老师的要求，写一个程序，模拟老师的询问。当然，老师有时候需要更新某位同学的成绩。</p>
<p>本题目包含多组测试，请处理到文件结束。<br>在每个测试的第一行，有两个正整数 N 和 M ( 0&lt;N&lt;=200000,0&lt;M&lt;5000 )，分别代表学生的数目和操作的数目。<br>学生ID编号分别从1编到N。<br>第二行包含N个整数，代表这N个学生的初始成绩，其中第i个数代表ID为i的学生的成绩。<br>接下来有M行。每一行有一个字符 C (只取’Q’或’U’) ，和两个正整数A，B。<br>当C为’Q’的时候，表示这是一条询问操作，它询问ID从A到B(包括A,B)的学生当中，成绩最高的是多少。<br>当C为’U’的时候，表示这是一条更新操作，要求把ID为A的学生的成绩更改为B。</p>
<p>/*</p>
<p>裸题一道,求区间最值</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINETREE</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">MAX</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,q,tree[<span class="number">3000000</span>],c,d;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)==<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">        q=in();</div><div class="line">        BUILD(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</div><div class="line">            <span class="keyword">char</span> inp=getchar();</div><div class="line">            <span class="keyword">while</span>(inp!=<span class="string">'Q'</span>&amp;&amp;inp!=<span class="string">'U'</span>)&#123;</div><div class="line">                inp=getchar();</div><div class="line">            &#125;</div><div class="line">            c=in();d=in();</div><div class="line">            <span class="keyword">if</span>(inp==<span class="string">'Q'</span>)&#123;</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,QUERY(c,d,<span class="number">1</span>,n,<span class="number">1</span>));</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span>&#123;</div><div class="line">                UPDATE(c,d,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">memset</span>(tree,<span class="number">0</span>,<span class="keyword">sizeof</span>(tree));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">MAX</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></div><div class="line">&#123;<span class="keyword">return</span> a&gt;b? a:b;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;</div><div class="line">        tree[rt]=in();</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    BUILD(lson);</div><div class="line">    BUILD(rson);</div><div class="line">    tree[rt]=MAX(tree[t],tree[t|<span class="number">1</span>]);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> new_data,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;</div><div class="line">        tree[rt]=new_data;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(pos&lt;=m)&#123;</div><div class="line">        UPDATE(pos,new_data,lson);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        UPDATE(pos,new_data,rson);</div><div class="line">    &#125;</div><div class="line">    tree[rt]=MAX(tree[t],tree[t|<span class="number">1</span>]);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span> pos_l,<span class="keyword">int</span> pos_r,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(pos_l&lt;=l&amp;&amp;r&lt;=pos_r)&#123;</div><div class="line">        <span class="keyword">return</span> tree[rt];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>,a=<span class="number">0</span>,b=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(pos_l&lt;=m)&#123;</div><div class="line">        a=QUERY(pos_l,pos_r,lson);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(pos_r&gt;m)&#123;</div><div class="line">        b=QUERY(pos_l,pos_r,rson);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> MAX(a,b);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">char</span> c=getchar();<span class="keyword">int</span> x=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>) c=getchar();</div><div class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar()) x=x*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><strong>COGS 1946 马拉松</strong></li>
</ul>
<p>作为一个狂热的马拉松爱好者，Bessie喜欢为她的同行们设计马拉松比赛。她最近刚设计了一款包含N(1 &lt;= N &lt;= 100,000)个检查站的马拉松比赛，比赛要求选手们必须依次通过这N个检查站。<br>不过，Bessie意识到很多牛们都没有体力跑完全程，她们会选择只跑其中一段。因此，她想知道其中的一段子赛程的长度，子赛程是由全赛程中一些相邻的检查站所组成的。Bessie还知道其它牛们都很懒，她们在跑某段子赛程时会跳过其中一个检查站——那个会导致该段赛程总长最小的检查站。不过不允许她们跳过该段子赛程中的第一个和最后一个点。<br>为了创建最可行的马拉松比赛，Bessie想调查一下如果改变当前赛程中某个检查站的位置会带来什么影响，请帮她计算改变某个检查站的位置后，跑完某段子赛程所需的最小长度，请注意奶牛们会在这段子赛程中跳过一个检查站。<br>因为比赛场地设在一个网格区域内，两个检查站之间距离的计算方法是：设两者位置坐标分别为(x1, y1)和(x2, y2)，则距离为|x1-x2| + |y1-y2|。</p>
<p>第一行有两个数N和Q(1 &lt;= Q &lt;= 100,000)；<br>接下来有N行，每行为一个检查站的位置坐标x,y，这N个点给出的顺序即为跑完全程所需依次经过的顺序，所有的坐标值均为-1000～1000的；<br>再接下来有Q行，表示位置更新或者查询，要求按给出的顺序依次进行处理。每一行的输入格式有两种情况：”U I X Y”或”Q I J”，如果是”U I X Y”格式的，表示第I(1 &lt;= I &lt;= N)号检查站的坐标要被更新为(X, Y)；如果是”Q I J”格式的，则表示要查询从第I号检查站到第J(I &lt;=<br>J)号检查站这段子赛程的最小长度，已知奶牛们会选择跳过这段赛程中的某一个点（I点和J点不允许跳过）。</p>
<p>/*</p>
<p>这题真的算是我打的中最难的一道了,调试了3节多课,有很多细节.下面说说我的思路,我开了一个结构体,一个存这个点到后面点的距离,一个存这个点直接跳过一个点到第三个点的可以节省的距离,所以说[i,j]的最好值就是区间的路程和减去区间的最大值,但要注意,更新一个点的坐标时,这个坐标会影响前两个点的坐标,所以说要更新3个点.</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINETREE</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"> </div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"> </div><div class="line"><span class="keyword">struct</span> ANYTHING&#123;</div><div class="line">	<span class="keyword">int</span> id,mx,data;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">struct</span> EVR&#123;</div><div class="line">	<span class="keyword">int</span> x,y;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">ANYTHING tree[<span class="number">1000000</span>];<span class="comment">//代表和后面相连的值</span></div><div class="line">EVR MAP[<span class="number">500001</span>];</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ABS</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">MAX</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function">ANYTHING <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> n,q,a,b,c,CUR_ID;</div><div class="line">ANYTHING ANS;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"marathona.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"marathona.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	n=in();q=in();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		MAP[i].x=in();</div><div class="line">		MAP[i].y=in();</div><div class="line">	&#125;</div><div class="line">	BUILD(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</div><div class="line">		<span class="keyword">char</span> inp=getchar();</div><div class="line">		<span class="keyword">while</span>(inp!=<span class="string">'Q'</span>&amp;&amp;inp!=<span class="string">'U'</span>)&#123;</div><div class="line">			inp=getchar();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(inp==<span class="string">'Q'</span>)&#123;</div><div class="line">			a=in();b=in();</div><div class="line">			<span class="keyword">if</span>(b-a&lt;=<span class="number">1</span>)&#123;</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ABS(MAP[b].x-MAP[a].x)+ABS(MAP[b].y-MAP[a].y));</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span>&#123;</div><div class="line">				ANS=QUERY(a,b<span class="number">-2</span>,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ABS(MAP[b].x-MAP[b<span class="number">-1</span>].x)+ABS(MAP[b].y-MAP[b<span class="number">-1</span>].y)+ANS.data-ANS.mx);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			a=in();b=in();c=in();</div><div class="line">			MAP[a].x=b;MAP[a].y=c;</div><div class="line">			UPDATE(a,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">			<span class="comment">/*</span></div><div class="line">			if(a&gt;1)&#123;</div><div class="line">				UPDATE(a-1,1,n,1);</div><div class="line">			&#125;</div><div class="line">			if(a&gt;2)&#123;</div><div class="line">				UPDATE(a-2,1,n,1);</div><div class="line">			&#125;*/</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ABS</span><span class="params">(<span class="keyword">int</span> temp)</span></span></div><div class="line">&#123;<span class="keyword">return</span> temp&gt;<span class="number">0</span>? temp:(-temp);&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">MAX</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></div><div class="line">&#123;<span class="keyword">return</span> a&gt;b? a:b;&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">char</span> c=getchar();<span class="keyword">int</span> x=<span class="number">0</span>;<span class="keyword">bool</span> flag=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)&#123;</div><div class="line">		<span class="keyword">if</span>(c==<span class="string">'-'</span>)&#123;</div><div class="line">			flag=<span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		c=getchar();</div><div class="line">	&#125;</div><div class="line"> </div><div class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())</div><div class="line">		x=x*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">	<span class="keyword">if</span>(flag) <span class="keyword">return</span> -x;</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;</div><div class="line">		CUR_ID++;</div><div class="line">		tree[rt].id=CUR_ID;</div><div class="line">        tree[rt].data=ABS(MAP[tree[rt].id].x-MAP[tree[rt].id+<span class="number">1</span>].x)+ABS(MAP[tree[rt].id].y-MAP[tree[rt].id+<span class="number">1</span>].y);</div><div class="line">        <span class="keyword">if</span>(tree[rt].id&lt;=n<span class="number">-2</span>)</div><div class="line">        	tree[rt].mx=tree[rt].data+ABS(MAP[tree[rt].id+<span class="number">1</span>].x-MAP[tree[rt].id+<span class="number">2</span>].x)+ABS(MAP[tree[rt].id+<span class="number">1</span>].y-MAP[tree[rt].id+<span class="number">2</span>].y)-ABS(MAP[tree[rt].id].x-MAP[tree[rt].id+<span class="number">2</span>].x)-ABS(MAP[tree[rt].id].y-MAP[tree[rt].id+<span class="number">2</span>].y);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    BUILD(lson);</div><div class="line">    BUILD(rson);</div><div class="line">    tree[rt].mx=MAX(tree[t].mx,tree[t|<span class="number">1</span>].mx);</div><div class="line">    tree[rt].data=tree[t].data+tree[t|<span class="number">1</span>].data;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;</div><div class="line">        tree[rt].data=ABS(MAP[tree[rt].id].x-MAP[tree[rt].id+<span class="number">1</span>].x)+ABS(MAP[tree[rt].id].y-MAP[tree[rt].id+<span class="number">1</span>].y);</div><div class="line">        <span class="keyword">if</span>(tree[rt].id&lt;=n<span class="number">-2</span>)</div><div class="line">        	tree[rt].mx=tree[rt].data+ABS(MAP[tree[rt].id+<span class="number">1</span>].x-MAP[tree[rt].id+<span class="number">2</span>].x)+ABS(MAP[tree[rt].id+<span class="number">1</span>].y-MAP[tree[rt].id+<span class="number">2</span>].y)-ABS(MAP[tree[rt].id].x-MAP[tree[rt].id+<span class="number">2</span>].x)-ABS(MAP[tree[rt].id].y-MAP[tree[rt].id+<span class="number">2</span>].y);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>((pos<span class="number">-1</span>&lt;=m&amp;&amp;pos&gt;<span class="number">1</span>)||(pos<span class="number">-2</span>&lt;=m&amp;&amp;pos&gt;<span class="number">2</span>)||(pos&lt;=m))&#123;</div><div class="line">        UPDATE(pos,lson);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(pos&gt;m)&#123;</div><div class="line">		UPDATE(pos,rson);</div><div class="line">    &#125;</div><div class="line">    tree[rt].mx=MAX(tree[t].mx,tree[t|<span class="number">1</span>].mx);</div><div class="line">    tree[rt].data=tree[t].data+tree[t|<span class="number">1</span>].data;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function">ANYTHING <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span> pos_l,<span class="keyword">int</span> pos_r,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(pos_l&lt;=l&amp;&amp;r&lt;=pos_r)&#123;</div><div class="line">        <span class="keyword">return</span> tree[rt];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">    ANYTHING a,b;</div><div class="line">    a.mx=b.mx=<span class="number">0</span>;</div><div class="line">	a.data=b.data=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(pos_l&lt;=m)&#123;</div><div class="line">        a=QUERY(pos_l,pos_r,lson);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(pos_r&gt;m)&#123;</div><div class="line">        b=QUERY(pos_l,pos_r,rson);</div><div class="line">    &#125;</div><div class="line">    a.mx=MAX(a.mx,b.mx);</div><div class="line">    a.data+=b.data;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><strong>HDU 2795 Billboard</strong></li>
</ul>
<p>At the entrance to the university, there is a huge rectangular billboard of size h*w (h is its height and w is its width). The board is the place where all possible announcements are posted: nearest programming competitions, changes in the dining room menu, and other important information.</p>
<p>On September 1, the billboard was empty. One by one, the announcements started being put on the billboard.</p>
<p>Each announcement is a stripe of paper of unit height. More specifically, the i-th announcement is a rectangle of size 1 * wi.</p>
<p>When someone puts a new announcement on the billboard, she would always choose the topmost possible position for the announcement. Among all possible topmost positions she would always choose the leftmost one.</p>
<p>If there is no valid location for a new announcement, it is not put on the billboard (that’s why some programming contests have no participants from this university).</p>
<p>Given the sizes of the billboard and the announcements, your task is to find the numbers of rows in which the announcements are placed.</p>
<p>/*</p>
<p>又是英文题….意思是一个大的墙长宽给你,有人要贴高为1,宽为w的海边,尽量靠左上贴,问你应该贴在第几行,不能输出-1.</p>
<p>可以转换为线段树,那么存的就是每一行剩余的空间,因为破墙很高所以建树的时候取墙和海报个数的最小值.</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINETREE</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">MAX</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">WORK</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> h,w,n,tree[<span class="number">1000000</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;h,&amp;w,&amp;n)==<span class="number">3</span>)&#123;</div><div class="line">		WORK();</div><div class="line">		<span class="built_in">memset</span>(tree,<span class="number">0</span>,<span class="keyword">sizeof</span>(tree));</div><div class="line">    &#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">MAX</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></div><div class="line">&#123;<span class="keyword">return</span> a&gt;b?a:b;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">char</span> c=getchar();</div><div class="line">    <span class="keyword">int</span> x=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)c=getchar();</div><div class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())x=x*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BUILD</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		tree[rt]=w;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	BUILD(lson);</div><div class="line">	BUILD(rson);</div><div class="line">	tree[rt]=w;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">WORK</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> tp=n;</div><div class="line">	<span class="keyword">if</span>(h&lt;n) tp=h;</div><div class="line">	BUILD(<span class="number">1</span>,tp,<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		h=in();</div><div class="line">		<span class="keyword">if</span>(h&gt;tree[<span class="number">1</span>])&#123;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			UPDATE(h,<span class="number">1</span>,tp,<span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span> new_data,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,l);</div><div class="line">		tree[rt]-=new_data;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(new_data&lt;=tree[t])&#123;</div><div class="line">		UPDATE(new_data,lson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span>&#123;</div><div class="line">		UPDATE(new_data,rson);</div><div class="line">	&#125;</div><div class="line">	tree[rt]=MAX(tree[t],tree[t|<span class="number">1</span>]);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><strong>POJ 2299  UltraQuickSort</strong></li>
</ul>
<p>Description</p>
<p>In this problem, you have to analyze a particular sorting algorithm. The algorithm processes a sequence of n distinct integers by swapping two adjacent sequence elements until the sequence is sorted in ascending order. For the input sequence<br>9 1 0 5 4 ,</p>
<p>Ultra-QuickSort produces the output<br>0 1 4 5 9 .</p>
<p>Your task is to determine how many swap operations Ultra-QuickSort needs to perform in order to sort a given input sequence.<br>Input</p>
<p>The input contains several test cases. Every test case begins with a line that contains a single integer n &lt; 500,000 – the length of the input sequence. Each of the the following n lines contains a single integer 0 ≤ a[i] ≤ 999,999,999, the i-th input sequence element. Input is terminated by a sequence of length n = 0. This sequence must not be processed.</p>
<p>/*</p>
<p>就是求个逆序对,转换到树状数组上,考虑到空间的限制,先离散化.而我闲的打成了线段树,和树状数组差100ms…</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> LS&#123;</div><div class="line">	<span class="keyword">int</span> ord,data;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">LS sorter[<span class="number">600000</span>];</div><div class="line"><span class="keyword">int</span> n,status[<span class="number">600000</span>],tree[<span class="number">1600000</span>];</div><div class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ans;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(LS,LS)</span></span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)==<span class="number">1</span>)&#123;</div><div class="line">		<span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">		work();</div><div class="line">		<span class="built_in">memset</span>(tree,<span class="number">0</span>,<span class="keyword">sizeof</span>(tree));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(LS A,LS B)</span></span></div><div class="line">&#123;<span class="keyword">return</span> A.data&lt;B.data;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">char</span> c=getchar();<span class="keyword">int</span> x=<span class="number">0</span>;<span class="keyword">bool</span> flag=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)&#123;</div><div class="line">		<span class="keyword">if</span>(c==<span class="string">'-'</span>) flag=<span class="number">1</span>;</div><div class="line">		c=getchar();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())&#123;</div><div class="line">		x=x*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(flag) <span class="keyword">return</span> -x;</div><div class="line">	<span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	ans=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		sorter[i].ord=i;</div><div class="line">		sorter[i].data=in();</div><div class="line">	&#125;</div><div class="line">	sort(sorter+<span class="number">1</span>,sorter+n+<span class="number">1</span>,comp);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		status[sorter[i].ord]=i;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		UPDATE(status[i],<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">		ans+=i-QUERY(status[i],<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">UPDATE</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		tree[rt]++;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(pos&lt;=m)&#123;</div><div class="line">		UPDATE(pos,lson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span>&#123;</div><div class="line">		UPDATE(pos,rson);</div><div class="line">	&#125;</div><div class="line">	tree[rt]=tree[t]+tree[t|<span class="number">1</span>];</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">QUERY</span><span class="params">(<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(R&gt;=r)&#123;</div><div class="line">		<span class="keyword">return</span> tree[rt];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>,SUM=<span class="number">0</span>;</div><div class="line">	SUM=QUERY(R,lson);</div><div class="line">	<span class="keyword">if</span>(R&gt;m)&#123;</div><div class="line">		SUM+=QUERY(R,rson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> SUM;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><strong>HDU 3577 Fast Arrangement</strong></li>
</ul>
<p>Problem Description</p>
<p>Chinese always have the railway tickets problem because of its’ huge amount of passangers and stations. Now goverment need you to develop a new tickets query system.<br>One train can just take k passangers. And each passanger can just buy one ticket from station a to station b. Each train cannot take more passangers any time. The one who buy the ticket earlier which can be sold will always get the ticket.</p>
<p>Input</p>
<p>The input contains servel test cases. The first line is the case number. In each test case:<br>The first line contains just one number k( 1 ≤ k ≤ 1000 ) and Q( 1 ≤ Q ≤ 100000 )<br>The following lines, each line contains two integers a and b, ( 1 ≤ a &lt; b ≤ 1000000 ), indicate a query.<br>Huge Input, scanf recommanded.</p>
<p>/*</p>
<p>延时标记</p>
<p>就是一个买票的系统,买了[i,j]的票,那么区间[i,j-1]的最大值加一,在下一个要买票的人中,他要途经的站中有一个区间的最大值超过K就不行.</p>
<p>*/</p>
<p>代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINE TREE</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> cson l,r,rt</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1000010LL</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> tree[MAXN*<span class="number">4</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> n=<span class="number">1000000</span>,T,k,q,posl,posr,tp,add[MAXN*<span class="number">4</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">//freopen("test.txt","r",stdin);</span></div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=T;i++)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>,i);</div><div class="line">		work();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;k,&amp;q);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;posl,&amp;posr);</div><div class="line">		posr--;</div><div class="line">		tp=Query(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">		<span class="keyword">if</span>(tp&gt;=k) <span class="keyword">continue</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,i);</div><div class="line">		Update(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">memset</span>(tree,<span class="number">0</span>,<span class="keyword">sizeof</span>(tree));</div><div class="line">	<span class="built_in">memset</span>(add,<span class="number">0</span>,<span class="keyword">sizeof</span>(add));</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"\n\n"</span>);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(add[rt]==<span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	add[t]+=add[rt];</div><div class="line">	add[t|<span class="number">1</span>]+=add[rt];</div><div class="line">	tree[t]+=add[rt];</div><div class="line">	tree[t|<span class="number">1</span>]+=add[rt];</div><div class="line">	add[rt]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(posl&lt;=l&amp;&amp;posr&gt;=r)&#123;</div><div class="line">		<span class="keyword">return</span> tree[rt];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>,Max=<span class="number">0</span>;</div><div class="line">	Clear(cson);</div><div class="line">	<span class="keyword">if</span>(posl&lt;=m)&#123;</div><div class="line">		<span class="keyword">int</span> temp=Query(lson);</div><div class="line">		<span class="keyword">if</span>(temp&gt;Max)&#123;</div><div class="line">			Max=temp;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(posr&gt;m)&#123;</div><div class="line">		<span class="keyword">int</span> temp=Query(rson);</div><div class="line">		<span class="keyword">if</span>(temp&gt;Max)&#123;</div><div class="line">			Max=temp;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	tree[rt]=MAX(tree[t],tree[t|<span class="number">1</span>]);</div><div class="line">	<span class="keyword">return</span> Max;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(posl&lt;=l&amp;&amp;posr&gt;=r)&#123;</div><div class="line">		tree[rt]++;</div><div class="line">		add[rt]++;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	Clear(cson);</div><div class="line">	<span class="keyword">if</span>(posl&lt;=m)&#123;</div><div class="line">		Update(lson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(posr&gt;m)&#123;</div><div class="line">		Update(rson);</div><div class="line">	&#125;</div><div class="line">	tree[rt]=MAX(tree[t],tree[t|<span class="number">1</span>]);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><strong>HDU 1698 Just a Hook</strong></li>
</ul>
<p>In the game of DotA, Pudge’s meat hook is actually the most horrible thing for most of the heroes. The hook is made up of several consecutive metallic sticks which are of the same length.</p>
<p>Now Pudge wants to do some operations on the hook.</p>
<p>Let us number the consecutive metallic sticks of the hook from 1 to N. For each operation, Pudge can change the consecutive metallic sticks, numbered from X to Y, into cupreous sticks, silver sticks or golden sticks.<br>The total value of the hook is calculated as the sum of values of N metallic sticks. More precisely, the value for each kind of stick is calculated as follows:</p>
<p>For each cupreous stick, the value is 1.<br>For each silver stick, the value is 2.<br>For each golden stick, the value is 3.</p>
<p>Pudge wants to know the total value of the hook after performing the operations.<br>You may consider the original hook is made up of cupreous sticks.</p>
<p>Input<br>The input consists of several test cases. The first line of the input is the number of the cases. There are no more than 10 cases.<br>For each case, the first line contains an integer N, 1&lt;=N&lt;=100,000, which is the number of the sticks of Pudge’s meat hook and the second line contains an integer Q, 0&lt;=Q&lt;=100,000, which is the number of the operations.<br>Next Q lines, each line contains three integers X, Y, 1&lt;=X&lt;=Y&lt;=N, Z, 1&lt;=Z&lt;=3, which defines an operation: change the sticks numbered from X to Y into the metal kind Z, where Z=1 represents the cupreous kind, Z=2 represents the silver kind and Z=3 represents the golden kind.</p>
<p>/*</p>
<p>又是英文题,说了半天废话,就是整个区间的初值是1,要你改区间的值..有一点要注意,add数值是0,不要CLEAR.</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINETREE</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100010</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,q,add[MAXN*<span class="number">5</span>],tree[MAXN*<span class="number">5</span>],T,posl,posr,new_data;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>;<span class="keyword">bool</span> flag=<span class="number">0</span>;<span class="keyword">char</span> c=getchar();</div><div class="line">	<span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)&#123;</div><div class="line">		<span class="keyword">if</span>(c==<span class="string">'-'</span>) flag=<span class="number">1</span>;</div><div class="line">		c=getchar();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())&#123;</div><div class="line">		x=x*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(flag) <span class="keyword">return</span> -x;</div><div class="line">	<span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> t=rt&lt;&lt;<span class="number">1</span>,m=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(add[rt]==<span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">	add[t]=add[rt];</div><div class="line">	add[t|<span class="number">1</span>]=add[rt];</div><div class="line">	tree[t]=(m-l+<span class="number">1</span>)*add[rt];</div><div class="line">	tree[t|<span class="number">1</span>]=(r-m)*add[rt];</div><div class="line">	add[rt]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(posl&lt;=l&amp;&amp;posr&gt;=r)&#123;</div><div class="line">		tree[rt]=(r-l+<span class="number">1</span>)*new_data;</div><div class="line">		add[rt]=new_data;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	Clear(l,r,rt);</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(posl&lt;=m)&#123;</div><div class="line">		Update(lson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(posr&gt;m)&#123;</div><div class="line">		Update(rson);</div><div class="line">	&#125;</div><div class="line">	tree[rt]=tree[t]+tree[t|<span class="number">1</span>];</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Work</span><span class="params">(<span class="keyword">int</span> F)</span></span>&#123;</div><div class="line">	<span class="built_in">memset</span>(add,<span class="number">0</span>,<span class="keyword">sizeof</span>(add));</div><div class="line">	<span class="comment">//memset(tree,0,sizeof(tree));</span></div><div class="line">	n=in();</div><div class="line">	add[<span class="number">1</span>]=<span class="number">1</span>;</div><div class="line">	q=in();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</div><div class="line">		posl=in();posr=in();new_data=in();</div><div class="line">		Update(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"Case %d: The total value of the hook is %d.\n"</span>,F,tree[<span class="number">1</span>]);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	T=in();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=T;i++)&#123;</div><div class="line">		Work(i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><strong>COGS 1317 数列操作c</strong></li>
</ul>
<p>所有答案小于4611686018427387904</p>
<p>【问题描述】<br>假设有一列数 {Ai }(1 ≤ i ≤ n),n&lt;=100000 ，支持如下两种操作：</p>
<p>(1)将 A i至A j 的值均增加 D 。（ i,j,D 是输入的数）</p>
<p>(2) 输出 A s +A s+1 +…+A t 。（ s, t 都是输入的数， S ≤ T ）</p>
<p>根据操作要求进行正确操作并输出结果。</p>
<p>【输入格式】</p>
<p>输入文件第一行一个整数 n ，<br>第二行为 n 个整数，表示 {A i } 的初始值。<br>第三行为一个整数 m ，表示操作数<br>v 下接 m 行，每行描述一个操作，有如下两种情况：</p>
<p>ADD i j d ( 表示将 A i至A j 的值均增加 D ， 1&lt;=i,j&lt;=n ， d 为整数 )</p>
<p>SUM s t （表示输出 A s +…+A t ）</p>
<p>/*</p>
<p>裸的延时标记..</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::LINETREE</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100001LL</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,t</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,t|1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> cson l,r,rt</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"> </div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"> </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">in</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Build</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function">ll <span class="title">Query</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> n,q,templ,tempr,left,right,new_data;</div><div class="line">ll tree[MAXN*<span class="number">5</span>],add[MAXN*<span class="number">5</span>];</div><div class="line"><span class="keyword">char</span> inp[<span class="number">10</span>];</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"shuliec.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"shuliec.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	n=in();</div><div class="line">	Build(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">	q=in();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,inp);</div><div class="line">		<span class="keyword">if</span>(inp[<span class="number">0</span>]==<span class="string">'S'</span>)&#123;</div><div class="line">			templ=in();tempr=in();</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,Query(<span class="number">1</span>,n,<span class="number">1</span>));</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			left=in();right=in();new_data=in();</div><div class="line">			Update(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">in</span><span class="params">()</span></span>&#123;</div><div class="line">	ll temp=<span class="number">0</span>;<span class="keyword">char</span> c=getchar();<span class="keyword">bool</span> flag=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)&#123;</div><div class="line">		<span class="keyword">if</span>(c==<span class="string">'-'</span>)&#123;</div><div class="line">			flag=<span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		c=getchar();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())&#123;</div><div class="line">		temp=temp*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(flag) <span class="keyword">return</span> -temp;</div><div class="line">	<span class="keyword">return</span> temp;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function">ll <span class="title">Query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(templ&lt;=l&amp;&amp;tempr&gt;=r)&#123;</div><div class="line">		<span class="keyword">return</span> tree[rt];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	ll ANS=<span class="number">0</span>;</div><div class="line">    Clear(cson);</div><div class="line">	<span class="keyword">if</span>(templ&lt;=m)&#123;</div><div class="line">		ANS+=Query(lson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(tempr&gt;m)&#123;</div><div class="line">		ANS+=Query(rson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ANS;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		add[rt]=<span class="number">0</span>;<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	add[t]+=add[rt];</div><div class="line">	add[t|<span class="number">1</span>]+=add[rt];</div><div class="line">	tree[t]+=add[rt]*(m-l+<span class="number">1</span>);</div><div class="line">	tree[t|<span class="number">1</span>]+=add[rt]*(r-m);</div><div class="line">	add[rt]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		tree[rt]=in();</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	Build(lson);</div><div class="line">	Build(rson);</div><div class="line">	tree[rt]=tree[t]+tree[t|<span class="number">1</span>];</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(left&lt;=l&amp;&amp;right&gt;=r)&#123;</div><div class="line">		tree[rt]+=new_data*(r-l+<span class="number">1</span>);</div><div class="line">		add[rt]+=new_data;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>,t=rt&lt;&lt;<span class="number">1</span>;</div><div class="line">	Clear(cson);</div><div class="line">	<span class="keyword">if</span>(left&lt;=m)&#123;</div><div class="line">		Update(lson);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(right&gt;m)&#123;</div><div class="line">		Update(rson);</div><div class="line">	&#125;</div><div class="line">	tree[rt]=tree[t]+tree[t|<span class="number">1</span>];</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>##2.单调队列#</p>
<p>关于这个,我暂时只打了两道,不是很裸,思维量还是很大的.</p>
<ul>
<li><strong>ARENA 22031 广告印刷</strong></li>
</ul>
<p>题目描述</p>
<p>最近，afy决定给TOJ印刷广告，广告牌是刷在城市的建筑物上的，城市里有紧靠着的N个建筑。afy决定在上面找一块尽可能大的矩形放置广告牌。我们假设每个建筑物都有一个高度，从左到右给出每个建筑物的高度H1,H2…HN，且0&lt;Hi&lt;=1,000,000,000，并且我们假设每个建筑物的宽度均为1。要求输出广告牌的最大面积。</p>
<p>输入</p>
<p>第一行是一个数n (n&lt;= 400,000)</p>
<p>第二行是n个数，分别表示每个建筑物高度H1,H2…HN，且0&lt;Hi&lt;=1,000,000,000。</p>
<p>/*</p>
<p>这题我几乎想了半天,最后发现很简单..无非就是求单个点左边和右边的连续高度大于等于它的,最后再枚举高度即可,忽略常数的话,效率可以达到O(n)</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::DEQUE</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 600010UL</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"> </div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"> </div><div class="line"><span class="keyword">struct</span> Deq&#123;</div><div class="line">    <span class="keyword">int</span> data[MAXN],tail,head,id[MAXN];</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">clr</span><span class="params">()</span></span>&#123;</div><div class="line">        tail=<span class="number">-1</span>;</div><div class="line">        head=<span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> tail&lt;head;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_back</span><span class="params">(<span class="keyword">int</span> temp,<span class="keyword">int</span> t_id)</span></span>&#123;</div><div class="line">        data[++tail]=temp;</div><div class="line">        id[tail]=t_id;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> temp,<span class="keyword">int</span> new_id)</span></span>&#123;</div><div class="line">        <span class="keyword">while</span>(!empty()&amp;&amp;data[tail]&gt;=temp)&#123;</div><div class="line">            tail--;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(empty())&#123;</div><div class="line">            push_back(temp,new_id);</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> rtn_id=id[tail];</div><div class="line">        push_back(temp,new_id);</div><div class="line">        <span class="keyword">return</span> rtn_id;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> n,Max,data[MAXN],left[MAXN],right[MAXN];</div><div class="line">Deq deq;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="comment">//freopen("t.txt","r",stdin);</span></div><div class="line">    <span class="comment">//freopen("","w",stdout);</span></div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    deq.clr();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;data[i]);</div><div class="line">        left[i]=i-deq.push_down(data[i],i)<span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    deq.clr();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">        right[n-i+<span class="number">1</span>]=i-deq.push_down(data[n-i+<span class="number">1</span>],i)<span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">        <span class="keyword">if</span>(Max&lt;(left[i]+right[i]+<span class="number">1</span>)*data[i])&#123;</div><div class="line">            Max=(left[i]+right[i]+<span class="number">1</span>)*data[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,Max);</div><div class="line">    <span class="comment">//fclose(stdin);</span></div><div class="line">    <span class="comment">//fclose(stdout);</span></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="comment">/**************************************************************</span></div><div class="line">    Problem: 22031</div><div class="line">    User: hznq60082</div><div class="line">    Language: C++</div><div class="line">    Result: 正确</div><div class="line">    Time:169 ms</div><div class="line">    Memory:12808 kb</div><div class="line">****************************************************************/</div></pre></td></tr></table></figure></p>
<ul>
<li><p><strong>ARENA 22030 Window</strong></p>
<p>  给你一个长度为N的数组，一个长为K的滑动的窗体从最左移至最右端，你只能见到窗口的K个数，每次窗体向右移动一位，如下表：</p>
</li>
</ul>
<p>Window position</p>
<p>Min value</p>
<p>Max value</p>
<p>[ 1 3 -1 ] -3 5 3 6 7</p>
<p>-1</p>
<p>3</p>
<p>1 [ 3 -1 -3 ] 5 3 6 7</p>
<p>-3</p>
<p>3</p>
<p>1 3 [ -1 -3 5 ] 3 6 7</p>
<p>-3</p>
<p>5</p>
<p>1 3 -1 [ -3 5 3 ] 6 7</p>
<p>-3</p>
<p>5</p>
<p>1 3 -1 -3 [ 5 3 6 ] 7</p>
<p>3</p>
<p>6</p>
<p>1 3 -1 -3 5 [ 3 6 7 ]</p>
<p>3</p>
<p>7</p>
<p>你的任务是找出窗口在各位置时的max value,min value.<br>数据范围：<br>20%： n&lt;=500; 50%: n&lt;=100000;<br>100%: n&lt;=1000000;</p>
<p>/*</p>
<p>算是一道裸题了,但是很多地方也要注意,就是pop_front的时候,要注意队首元素的id和要pop的一不一样,一样的话pop,反之不pop,不能只判断入单调队列时的pop的个数.</p>
<p>*/</p>
<p>代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//AUTHOR::STDAFX</span></div><div class="line"><span class="comment">//ALGORITHM::DEQUE</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1000010UL</span></div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"> </div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"> </div><div class="line"><span class="keyword">struct</span> Deq&#123;</div><div class="line">    <span class="keyword">int</span> data[MAXN],tail,head,id[MAXN];</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">clr</span><span class="params">()</span></span>&#123;</div><div class="line">        tail=<span class="number">-1</span>;</div><div class="line">        head=<span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> tail&lt;head;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pop_front</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(!empty())&#123;</div><div class="line">            head++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_back</span><span class="params">(<span class="keyword">int</span> temp,<span class="keyword">int</span> new_id)</span></span>&#123;</div><div class="line">        data[++tail]=temp;</div><div class="line">        id[tail]=new_id;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pop_back</span><span class="params">()</span></span>&#123;</div><div class="line">        tail--;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">front</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> data[head];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">front_id</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> id[head];</div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">back</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> data[tail];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> temp,<span class="keyword">int</span> new_id)</span></span>&#123;</div><div class="line">        <span class="keyword">while</span>(!empty()&amp;&amp;back()&gt;temp)&#123;</div><div class="line">            pop_back();</div><div class="line">        &#125;</div><div class="line">        push_back(temp,new_id);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> temp,<span class="keyword">int</span> new_id)</span></span>&#123;</div><div class="line">        <span class="keyword">while</span>(!empty()&amp;&amp;back()&lt;temp)&#123;</div><div class="line">            pop_back();</div><div class="line">        &#125;</div><div class="line">        push_back(temp,new_id);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">Deq deq_max,deq_min;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> Max[MAXN],Min[MAXN],n,length,temp,cs;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="comment">//freopen("t.txt","r",stdin);</span></div><div class="line">    <span class="comment">//freopen("","w",stdout);</span></div><div class="line">    n=in();length=in();</div><div class="line">    deq_max.clr();deq_min.clr();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">        temp=in();</div><div class="line">        deq_max.push_down(temp,i);</div><div class="line">        deq_min.push_up(temp,i);</div><div class="line">        <span class="keyword">if</span>(i==length)&#123;</div><div class="line">            cs++;</div><div class="line">            Max[cs]=deq_max.front();</div><div class="line">            Min[cs]=deq_min.front();</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(i&gt;length)&#123;</div><div class="line">            <span class="keyword">if</span>(deq_max.front_id()==i-length)&#123;</div><div class="line">                deq_max.pop_front();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(deq_min.front_id()==i-length)&#123;</div><div class="line">                deq_min.pop_front();</div><div class="line">            &#125;          </div><div class="line">            cs++;</div><div class="line">            Max[cs]=deq_max.front();</div><div class="line">            Min[cs]=deq_min.front();   </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,Min[<span class="number">1</span>]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=cs;i++)&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">" %d"</span>,Min[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,Max[<span class="number">1</span>]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=cs;i++)&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">" %d"</span>,Max[i]);</div><div class="line">    &#125;  </div><div class="line">    <span class="comment">//fclose(stdin);</span></div><div class="line">    <span class="comment">//fclose(stdout);  </span></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">in</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> temp=<span class="number">0</span>;<span class="keyword">bool</span> flag=<span class="number">0</span>;<span class="keyword">char</span> c=getchar();</div><div class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)&#123;</div><div class="line">        <span class="keyword">if</span>(c==<span class="string">'-'</span>) flag=<span class="number">1</span>;</div><div class="line">        c=getchar();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=getchar())&#123;</div><div class="line">        temp=temp*<span class="number">10</span>+c<span class="number">-48</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(flag) <span class="keyword">return</span> -temp;</div><div class="line">    <span class="keyword">return</span> temp;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="comment">/**************************************************************</span></div><div class="line">    Problem: 22030</div><div class="line">    User: hznq60082</div><div class="line">    Language: C++</div><div class="line">    Result: 正确</div><div class="line">    Time:409 ms</div><div class="line">    Memory:24528 kb</div><div class="line">****************************************************************/</div></pre></td></tr></table></figure></p>
<p>2015.6.7</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/总结/" rel="tag"># 总结</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/06/06/5-15-6-5-OI-总结/" rel="next" title="5.15-6.5 OI 总结(DP)">
                <i class="fa fa-chevron-left"></i> 5.15-6.5 OI 总结(DP)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/06/09/今天是个开学的好日子-2015-6-9/" rel="prev" title="今天是个开学的好日子 2015.6.9">
                今天是个开学的好日子 2015.6.9 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2015/06/07/5-15-6-5-OI-总结2/"
     data-title="5.15-6.5 OI 总结2(线段树,单调队列)"
     data-content=""
     data-url="http://stdafx.ga/2015/06/07/5-15-6-5-OI-总结2/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2015/06/07/5-15-6-5-OI-总结2/"
           data-title="5.15-6.5 OI 总结2(线段树,单调队列)" data-url="http://stdafx.ga/2015/06/07/5-15-6-5-OI-总结2/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="stdafx" />
          <p class="site-author-name" itemprop="name">stdafx</p>
          <p class="site-description motion-element" itemprop="description">Why Be A King When You Can Be A God ?</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">25</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/lawyer/p/" title="phx" target="_blank">phx</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/hzoi_ztx" title="ztx" target="_blank">ztx</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://lzy-foenix.gitcafe.io/" title="lzy" target="_blank">lzy</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/joyouth/" title="ad" target="_blank">ad</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/qq_34025203?viewmode=contents" title="syx" target="_blank">syx</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/assassain/" title="lyc" target="_blank">lyc</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/Candyouth/" title="smz" target="_blank">smz</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/lglin000" title="lgl" target="_blank">lgl</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/zzzzzfy" title="zfy" target="_blank">zfy</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">stdafx</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"stdafx"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  

  


</body>
</html>
